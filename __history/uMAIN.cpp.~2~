//---------------------------------------------------------------------------

#include <vcl.h>
#pragma hdrstop
using namespace std;

#include "uMAIN.h"
#include <filesystem>

//---------------------------------------------------------------------------
#pragma package(smart_init)
#pragma resource "*.dfm"
TForm1 *Form1;

void unzipDOCX(string file) {
	string path = filesystem::path(file).parent_path().u8string();
	system(("cd " + path + " && mkdir temp && cd temp && tar -xf " + file).c_str());
}


//---------------------------------------------------------------------------
__fastcall TForm1::TForm1(TComponent* Owner)
	: TForm(Owner)
{
}
//---------------------------------------------------------------------------
void __fastcall TForm1::ÂûáðàòüClick(TObject *Sender)
{
	if (OpenDialogDOCX->Execute()) {
		PATH->Text = OpenDialogDOCX->FileName;
	}
}
//---------------------------------------------------------------------------
void __fastcall TForm1::UNZIPClick(TObject *Sender)
{
	unzipDOCX(AnsiString(PATH->Text).c_str());
}
//---------------------------------------------------------------------------
